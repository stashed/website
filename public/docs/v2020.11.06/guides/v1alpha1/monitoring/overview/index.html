<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-62096468-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#5E2DEA"><title>Stash by AppsCode</title><meta name=description content="Stash by AppsCode is a cloud native data backup and recovery solution for Kubernetes workloads, volumes and databases"><meta name=author content="AppsCode Inc."><meta name=keywords content="kubernetes appscode backup disaster recovery volume"><link rel=apple-touch-icon sizes=57x57 href=/assets/images/products/stash/icons/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/products/stash/icons/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/products/stash/icons/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/products/stash/icons/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/products/stash/icons/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/products/stash/icons/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/products/stash/icons/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/products/stash/icons/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/products/stash/icons/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/assets/images/products/stash/icons/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/products/stash/icons/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/assets/images/products/stash/icons/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/products/stash/icons/favicon-16x16.png><link rel=manifest href=/assets/images/products/stash/icons/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/assets/images/products/stash/icons/ms-icon-144x144.png"><meta itemprop=name content="Stash by AppsCode"><meta itemprop=description content="Stash by AppsCode is a cloud native data backup and recovery solution for Kubernetes workloads, volumes and databases"><meta itemprop=image content="https://stash.run/assets/images/products/stash/stash-1280x640.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@KubeStash"><meta name=twitter:title content="Stash by AppsCode"><meta name=twitter:creator content="@KubeStash"><meta name=twitter:description content="Stash by AppsCode is a cloud native data backup and recovery solution for Kubernetes workloads, volumes and databases"><meta name=twitter:image:src content="https://stash.run/assets/images/products/stash/stash-1280x640.png"><meta property="og:url" content="https://stash.run"><meta property="og:title" content="Stash by AppsCode"><meta property="og:description" content="Stash by AppsCode is a cloud native data backup and recovery solution for Kubernetes workloads, volumes and databases"><meta property="og:site_name" content="Stash by AppsCode"><meta property="og:image" content="https://stash.run/assets/images/products/stash/stash-1280x640.png"><meta property="og:type" content="article"><link rel=stylesheet href=/assets/css/font-awesome.min.css><link href=https://unpkg.com/aos@2.3.1/dist/aos.css rel=stylesheet><link rel=stylesheet href=/assets/css/bulma-carousel.min.css><link rel=stylesheet href=/assets/css/bulma-tooltip.min.css><link rel=stylesheet href=/assets/css/bulma.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/keen-slider@latest/keen-slider.min.css><link rel=stylesheet href=/assets/sass/main.min.441db70d1d9b65470fae58d28c1cf4c352f5a4cf9d8d1cbffb7094dcea7a0b02.css></head><body class=stash><header><div class=header-top><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav1><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav1 class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Products</a><div class=ac-megamenu><div class=columns><div class="column is-6"><div class=columns><div class="column is-12 br-1"><a href=https://kubedb.com class="single-product-item is-kubedb"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubedb/kubedb-icon.png alt=KubeDB></div><h5>KubeDB</h5></div><div class=menu-body><p>Run production-grade Databases on Kubernetes</p></div></a><a href=https://stash.run class="single-product-item is-stash"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/stash/stash-icon.png alt=Stash></div><h5>Stash</h5></div><div class=menu-body><p>Backup your Kubernetes Stateful Applications</p></div></a><a href=https://kubevault.com class="single-product-item is-kubevault"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubevault/kubevault-icon.png alt=KubeVault></div><h5>KubeVault</h5></div><div class=menu-body><p>Tools for running HashiCorp Vault on Kubernetes</p></div></a></div></div></div><div class="column is-6"><div class=columns><div class="column is-12"><a href=https://byte.builders class="single-product-item byte-builder kd-orange"><div class=menu-header><p class=intro>Introducing....</p><h5>ByteBuilders</h5></div><div class=menu-body><p>Cloud reimagined for the age of Kubernetes</p></div><p class=learn-more-btn>Learn more
<span class=icon><i class="fa fa-long-arrow-right" aria-hidden=true></i></span></p></a><a href=https://kubeform.com class="single-product-item is-kubeform"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubeform/kubeform-icon.png alt=Kubeform></div><h5>Kubeform</h5></div><div class=menu-body><p>Provision cloud resources using Kubernetes CRDs & Terraform</p></div></a></div></div></div></div></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Open Source</a><div class=ac-megamenu><div class=columns><div class="column is-6"><div class=columns><div class="column is-12 br-1"><a href=https://voyagermesh.com class="single-product-item is-voyager"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/voyager/voyager-icon.png alt=Voyager></div><h5>Voyager</h5></div><div class=menu-body><p>Secure HAProxy Ingress Controller for
Kubernetes</p></div></a><a href=https://appscode.com/products/guard/ class="single-product-item is-guard"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/guard/guard-icon.png alt=Guard></div><h5>Guard</h5></div><div class=menu-body><p>Kubernetes Authentication WebHook Server</p></div></a><a href=https://appscode.com/products/kubed/ class="single-product-item is-kubed"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubed/kubed-icon.png alt=Kubed></div><h5>Kubed</h5></div><div class=menu-body><p>Kubernetes cluster manager daemon</p></div></a></div></div></div><div class="column is-6"><div class=columns><div class="column is-12"><a href=https://pharmer.cloud class="single-product-item is-pharmer"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/pharmer/pharmer-icon.png alt=Pharmer></div><h5>Pharmer</h5></div><div class=menu-body><p>Kubernetes Cluster Manager using Kubeadm & Cluster API</p></div></a><a href=https://appscode.com/products/swift/ class="single-product-item is-swift"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/swift/swift-icon.png alt=Swift></div><h5>Swift</h5></div><div class=menu-body><p>Ajax friendly Helm Tiller Proxy</p></div></a><a href=https://appscode.com/products/searchlight/ class="single-product-item is-searchlight"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/searchlight/searchlight-icon.png alt=Searchlight></div><h5>Searchlight</h5></div><div class=menu-body><p>Alerts for Kubernetes</p></div></a></div></div></div></div></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Services</a><div class=ac-dropdown><a class=navbar-item href=https://appscode.com/consulting/>Consulting</a>
<a class=navbar-item href=https://appscode.com/training/>Training</a>
<a class=navbar-item href=https://appscode.com/support/>Support</a></div></div><a class=navbar-item href=https://blog.byte.builders>Blog</a>
<a class=navbar-item href=https://appscode.com/contact/>Contact Us</a></div><div class=navbar-item><div class="buttons main-menu-button-top"><a class="button is-small for-chat" href=https://slack.appscode.com><span><img src=/assets/images/icon/slack.png alt></span>Slack</a>
<a class="button is-small for-support" href=https://appscode.freshdesk.com><span><img src=/assets/images/icon/chat.png alt></span>Support Portal</a></div></div></div></div></nav></div></div><div class="header-bottom-area header-area kubedb-primary-bg customize-kubedb fixed-menu"><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://stash.run><img src=/assets/images/products/stash/stash-white.png alt=Stash></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><a href=/features/ class=navbar-item>Features</a>
<a href=/pricing/ class=navbar-item>Pricing</a>
<a href=/docs/v2020.11.17/welcome/ class=navbar-item>Documentation</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Community</a><div class=ac-dropdown><a href=https://github.com/stashed class=navbar-item>GitHub</a>
<a href=https://twitter.com/KubeStash class=navbar-item>Twitter</a>
<a href=https://slack.appscode.com class=navbar-item>Slack</a></div></div></div><div class=navbar-item><div class="buttons main-menu-button"><img style=height:24px alt="GitHub Stars" src="https://img.shields.io/badge/dynamic/json?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=github&label=stars&query=%24.stars&url=https://github-stars.appscode.workers.dev/user/stashed">
&nbsp;&nbsp;&nbsp;
<img style=height:24px alt="GitHub Forks" src="https://img.shields.io/badge/dynamic/json?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=github&label=forks&query=%24.forks&url=https://github-stars.appscode.workers.dev/user/stashed">
&nbsp;&nbsp;&nbsp;
<img style=height:24px alt="Docker Pulls" src="https://img.shields.io/docker/pulls/appscode/stash?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=docker&label=pulls"></div></div></div></div></nav></div></div><div class=documentation-menu><div class="container section"><div class=is-centered><div class="is-half has-text-centered-desktop"><div class=responsive-menu><a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav3><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><nav class=documentation-navbar><div id=acNav3 class="navbar-menu nav-menu main-menu"><div class=navbar-centered><div class=navbar-start><a href=/docs/v2020.11.06/ class=navbar-item>Welcome</a>
<a href=/docs/v2020.11.06/concepts/ class=navbar-item>Concepts</a>
<a href=/docs/v2020.11.06/setup/ class=navbar-item>Setup</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Guides</a><div class=ac-dropdown><a href=/docs/v2020.11.06/guides/latest/ class=navbar-item>Latest Guides</a>
<a href=/docs/v2020.11.06/guides/v1alpha1/ class=navbar-item>v1alpha1 Guides</a></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Addons</a><div class=ac-dropdown><a href=/docs/v2020.11.06/addons/postgres/ class=navbar-item>Postgres</a>
<a href=/docs/v2020.11.06/addons/elasticsearch/ class=navbar-item>Elasticsearch</a>
<a href=/docs/v2020.11.06/addons/mysql/ class=navbar-item>MySQL</a>
<a href=/docs/v2020.11.06/addons/mongodb/ class=navbar-item>MongoDB</a>
<a href=/docs/v2020.11.06/addons/percona-xtradb/ class=navbar-item>Percona XtraDB</a></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Reference</a><div class=ac-dropdown><a href=/docs/v2020.11.06/reference/operator/ class=navbar-item>Stash Operator</a>
<a href=/docs/v2020.11.06/reference/cli/ class=navbar-item>Stash CLI</a></div></div></div></div></div></nav></div></div></div></div></header><div class=documentation-area><div class="container section"><div class=columns><div class="column is-3"><div class=kd-left-sidebar><div class=trial-button><a href=/docs/v2020.11.17/setup/ class="button is-fullwidth">Try Now for FREE!</a></div><div class=kd-version><div class=dropdown><div class=dropdown-trigger><button class="button is-fullwidth" aria-haspopup=true aria-controls=dropdown-menu3>
<span><strong class=icon><i class="fa fa-cog" aria-hidden=true></i></strong>v2020.11.06</span>
<span class="icon is-small"><i class="fa fa-angle-down" aria-hidden=true></i></span></button></div><div class=dropdown-menu id=dropdown-menu3 role=menu><div class=dropdown-content><a href=https://github.com/stashed/docs/tree/master/docs target=_blank class=dropdown-item>master</a>
<a href=/docs/v2020.11.17/ class=dropdown-item>v2020.11.17<div class=tag>Latest</div></a><a href=/docs/v2020.11.06/ class=dropdown-item>v2020.11.06</a>
<a href=/docs/v2020.10.30/ class=dropdown-item>v2020.10.30</a>
<a href=/docs/v2020.10.29/ class=dropdown-item>v2020.10.29</a>
<a href=/docs/v2020.10.21/ class=dropdown-item>v2020.10.21</a>
<a href=/docs/v2020.09.29/ class=dropdown-item>v2020.09.29</a>
<a href=/docs/v2020.09.16/ class=dropdown-item>v2020.09.16</a>
<a href=/docs/v2020.08.27/ class=dropdown-item>v2020.08.27</a>
<a href=/docs/v0.9.0-rc.6/ class=dropdown-item>v0.9.0-rc.6</a></div></div></div></div><div class=kd-sidebar-menu><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-1>
<label for=13bb8679dff649c57574cf3ea0db5ff2-1><a href=/docs/v2020.11.06/guides/v1alpha1/>v1alpha1 Guides</a></label></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-2>
<label for=13bb8679dff649c57574cf3ea0db5ff2-2><a href=/docs/v2020.11.06/guides/v1alpha1/backup/>Backup Volumes</a></label></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-3>
<label for=13bb8679dff649c57574cf3ea0db5ff2-3><a href=/docs/v2020.11.06/guides/v1alpha1/offline_backup/>Offline Backup</a></label></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-4>
<label for=13bb8679dff649c57574cf3ea0db5ff2-4><a href=/docs/v2020.11.06/guides/v1alpha1/restore/>Restore Volumes</a></label></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-5>
<label for=13bb8679dff649c57574cf3ea0db5ff2-5><a href=/docs/v2020.11.06/guides/v1alpha1/workloads/>Workloads</a></label></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-6>
<label for=13bb8679dff649c57574cf3ea0db5ff2-6><a>Supported Backends</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/overview/>What is Backend?</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/local/>Persistent Volumes</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/s3/>AWS S3</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/azure/>Azure Blob Storage</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/gcs/>Google Cloud Storage</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/swift/>OpenStack Swift</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/backends/b2/>Backblaze B2</a></li></ul></div></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-7>
<label for=13bb8679dff649c57574cf3ea0db5ff2-7><a>Platforms</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2020.11.06/guides/v1alpha1/platforms/eks/>EKS</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/platforms/aks/>AKS</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/platforms/gke/>GKE</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/platforms/minio/>Minio</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/platforms/rook/>Rook</a></li></ul></div></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-8 checked>
<label for=13bb8679dff649c57574cf3ea0db5ff2-8><a>Monitoring</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li class=is-active><a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/overview/>Overview</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/builtin/>Builtin Prometheus</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/coreos/>Prometheus Operator</a></li><li><a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/grafana/>Using Grafana</a></li></ul></div></div><div class=item><input type=checkbox id=13bb8679dff649c57574cf3ea0db5ff2-9>
<label for=13bb8679dff649c57574cf3ea0db5ff2-9><a href=/docs/v2020.11.06/guides/v1alpha1/rbac/>RBAC</a></label></div></div></div></div><div class="column is-7"><div class=full-info><blockquote><p>New to Stash? Please start <a href=/docs/v2020.11.06/concepts/README>here</a>.</p></blockquote><h1 id=monitoring-stash>Monitoring Stash</h1><p>Stash has native support for monitoring via <a href=https://prometheus.io/>Prometheus</a>. You can use builtin <a href=https://github.com/prometheus/prometheus>Prometheus</a> scraper or <a href=https://github.com/coreos/prometheus-operator>CoreOS Prometheus Operator</a> to monitor Stash. This tutorial will show you how this monitoring works with Stash and how to enable them.</p><h2 id=overview>Overview</h2><p>Stash uses <a href=https://github.com/prometheus/pushgateway>Prometheus PushGateway</a> to export the metrics for backup & recovery operations. Following diagram shows the logical structure of Stash monitoring flow.</p><p align=center>  <img alt="Monitoring Structure" src=/docs/v2020.11.06/images/v1alpha1/monitoring/stash-monitoring-structure.png></p><p>Stash operator runs two containers. The <code>operator</code> container runs controller and other necessary stuffs and the <code>pushgateway</code> container runs <a href=https://hub.docker.com/r/prom/pushgateway>prom/pushgateway</a> image. Stash sidecar from different workloads pushes their metrics to this pushgateway. Then Prometheus server scraps these metrics through <code>stash-operator</code> service. Stash operator itself also provides some metrics at <code>/metrics</code> path of <code>:8443</code> port.</p><h3 id=backup--recovery-metrics>Backup & Recovery Metrics</h3><p>Following metrics are available for stash backup and recovery operations. These metrics are accessible through <code>pushgateway</code> endpoint of <code>stash-operator</code> service.</p><table><thead><tr><th>Metric</th><th>Uses</th></tr></thead><tbody><tr><td><code>restic_session_success</code></td><td>Indicates if session was successfully completed</td></tr><tr><td><code>restic_session_fail</code></td><td>Indicates if session failed</td></tr><tr><td><code>restic_session_duration_seconds_total</code></td><td>Seconds taken to complete restic session for all FileGroups</td></tr><tr><td><code>restic_session_duration_seconds</code></td><td>Seconds taken to complete restic session for a FileGroup</td></tr></tbody></table><h3 id=operator-metrics>Operator Metrics</h3><p>Following metrics are available for Stash operator. These metrics are accessible through <code>api</code> endpoint of <code>stash-operator</code> service.</p><p><strong>API Server Metrics:</strong></p><table><thead><tr><th>Metric Name</th><th>Uses</th></tr></thead><tbody><tr><td>apiserver_audit_event_total</td><td>Counter of audit events generated and sent to the audit backend.</td></tr><tr><td>apiserver_client_certificate_expiration_seconds</td><td>Distribution of the remaining lifetime on the certificate used to authenticate a request.</td></tr><tr><td>apiserver_current_inflight_requests</td><td>Maximal number of currently used inflight request limit of this apiserver per request kind in last second.</td></tr><tr><td>apiserver_request_count</td><td>Counter of apiserver requests broken out for each verb, API resource, client, and HTTP response contentType and code.</td></tr><tr><td>apiserver_request_latencies</td><td>Response latency distribution in microseconds for each verb, resource and subresource.</td></tr><tr><td>apiserver_request_latencies_summary</td><td>Response latency summary in microseconds for each verb, resource and subresource.</td></tr><tr><td>authenticated_user_requests</td><td>Counter of authenticated requests broken out by username.</td></tr></tbody></table><p><strong>Go Metrics:</strong></p><table><thead><tr><th>Metric Name</th><th>Uses</th></tr></thead><tbody><tr><td>go_gc_duration_seconds</td><td>A summary of the GC invocation durations.</td></tr><tr><td>go_goroutines</td><td>Number of goroutines that currently exist.</td></tr><tr><td>go_memstats_alloc_bytes</td><td>Number of bytes allocated and still in use.</td></tr><tr><td>go_memstats_alloc_bytes_total</td><td>Total number of bytes allocated, even if freed.</td></tr><tr><td>go_memstats_buck_hash_sys_bytes</td><td>Number of bytes used by the profiling bucket hash table.</td></tr><tr><td>go_memstats_frees_total</td><td>Total number of frees.</td></tr><tr><td>go_memstats_gc_sys_bytes</td><td>Number of bytes used for garbage collection system metadata.</td></tr><tr><td>go_memstats_heap_alloc_bytes</td><td>Number of heap bytes allocated and still in use.</td></tr><tr><td>go_memstats_heap_idle_bytes</td><td>Number of heap bytes waiting to be used.</td></tr><tr><td>go_memstats_heap_inuse_bytes</td><td>Number of heap bytes that are in use.</td></tr><tr><td>go_memstats_heap_objects</td><td>Number of allocated objects.</td></tr><tr><td>go_memstats_heap_released_bytes_total</td><td>Total number of heap bytes released to OS.</td></tr><tr><td>go_memstats_heap_sys_bytes</td><td>Number of heap bytes obtained from system.</td></tr><tr><td>go_memstats_last_gc_time_seconds</td><td>Number of seconds since 1970 of last garbage collection.</td></tr><tr><td>go_memstats_lookups_total</td><td>Total number of pointer lookups.</td></tr><tr><td>go_memstats_mallocs_total</td><td>Total number of mallocs.</td></tr><tr><td>go_memstats_mcache_inuse_bytes</td><td>Number of bytes in use by mcache structures.</td></tr><tr><td>go_memstats_mcache_sys_bytes</td><td>Number of bytes used for mcache structures obtained from system.</td></tr><tr><td>go_memstats_mspan_inuse_bytes</td><td>Number of bytes in use by mspan structures.</td></tr><tr><td>go_memstats_mspan_sys_bytes</td><td>Number of bytes used for mspan structures obtained from system.</td></tr><tr><td>go_memstats_next_gc_bytes</td><td>Number of heap bytes when next garbage collection will take place.</td></tr><tr><td>go_memstats_other_sys_bytes</td><td>Number of bytes used for other system allocations.</td></tr><tr><td>go_memstats_stack_inuse_bytes</td><td>Number of bytes in use by the stack allocator.</td></tr><tr><td>go_memstats_stack_sys_bytes</td><td>Number of bytes obtained from system for stack allocator.</td></tr><tr><td>go_memstats_sys_bytes</td><td>Number of bytes obtained by system. Sum of all system allocations.</td></tr></tbody></table><p><strong>HTTP Metrics:</strong></p><table><thead><tr><th>Metrics</th><th>Uses</th></tr></thead><tbody><tr><td>http_request_duration_microseconds</td><td>The HTTP request latencies in microseconds.</td></tr><tr><td>http_request_size_bytes</td><td>The HTTP request sizes in bytes.</td></tr><tr><td>http_requests_total</td><td>Total number of HTTP requests made.</td></tr><tr><td>http_response_size_bytes</td><td>The HTTP response sizes in bytes.</td></tr></tbody></table><p><strong>Process Metrics:</strong></p><table><thead><tr><th>Metric Name</th><th>Uses</th></tr></thead><tbody><tr><td>process_cpu_seconds_total</td><td>Total user and system CPU time spent in seconds.</td></tr><tr><td>process_max_fds</td><td>Maximum number of open file descriptors.</td></tr><tr><td>process_open_fds</td><td>Number of open file descriptors.</td></tr><tr><td>process_resident_memory_bytes</td><td>Resident memory size in bytes.</td></tr><tr><td>process_start_time_seconds</td><td>Start time of the process since unix epoch in seconds.</td></tr><tr><td>process_virtual_memory_bytes</td><td>Virtual memory size in bytes.</td></tr></tbody></table><h2 id=how-to-enable-monitoring>How to Enable Monitoring</h2><p>You can enable monitoring through some flags while installing or upgrading or updating Stash. You can also chose which monitoring agent to use for monitoring. Stash will configure respective resources accordingly. Here, are the list of available flags and their uses,</p><table><thead><tr><th>Script Flag</th><th>Helm Values</th><th>Acceptable Values</th><th>Default</th><th>Uses</th></tr></thead><tbody><tr><td><code>--monitoring-agent</code></td><td><code>monitoring.agent</code></td><td><code>prometheus.io/builtin</code> or <code>prometheus.io/coreos-operator</code></td><td><code>none</code></td><td>Specify which monitoring agent to use for monitoring Stash.</td></tr><tr><td><code>--monitoring-backup</code></td><td><code>monitoring.backup</code></td><td><code>true</code> or <code>false</code></td><td><code>false</code></td><td>Specify whether to monitor Stash backup and recovery.</td></tr><tr><td><code>--monitoring-operator</code></td><td><code>monitoring.operator</code></td><td><code>true</code> or <code>false</code></td><td><code>false</code></td><td>Specify whether to monitor Stash operator.</td></tr><tr><td><code>--prometheus-namespace</code></td><td><code>monitoring.prometheus.namespace</code></td><td>any namespace</td><td>same namespace as Stash operator</td><td>Specify the namespace where Prometheus server is running or will be deployed</td></tr><tr><td><code>--servicemonitor-label</code></td><td><code>monitoring.serviceMonitor.labels</code></td><td>any label</td><td>For Helm installation, <code>app: &lt;generated app name></code> and <code>release: &lt;release name></code>. For script installation, <code>app: stash</code></td><td>Specify the labels for ServiceMonitor. Prometheus crd will select ServiceMonitor using these labels. Only usable when monitoring agent is <code>prometheus.io/coreos-operator</code>.</td></tr></tbody></table><p>You have to provides these flags while installing or upgrading or updating Stash. Here, are examples for both script and Helm installation process are given which enable monitoring with <code>prometheus.io/coreos-operator</code> Prometheuse server for <code>backup & recovery</code> and <code>operator</code> metrics.</p><p><strong>Helm 3:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ helm install stash-operator appscode/stash --version v2020.11.06 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --namespace kube-system <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.agent<span style=color:#f92672>=</span>prometheus.io/coreos-operator <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.backup<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.operator<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.prometheus.namespace<span style=color:#f92672>=</span>monitoring <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.serviceMonitor.labels.k8s-app<span style=color:#f92672>=</span>prometheus
</code></pre></div><p><strong>Helm 2:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ helm install appscode/stash --name stash-operator --version v2020.11.06 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --namespace kube-system <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.agent<span style=color:#f92672>=</span>prometheus.io/coreos-operator <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.backup<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.operator<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.prometheus.namespace<span style=color:#f92672>=</span>monitoring <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.serviceMonitor.labels.k8s-app<span style=color:#f92672>=</span>prometheus
</code></pre></div><p><strong>YAML (with Helm 3):</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ helm template stash-operator appscode/stash --version v2020.11.06 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --namespace kube-system <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --no-hooks <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.agent<span style=color:#f92672>=</span>prometheus.io/coreos-operator <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.backup<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.operator<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.prometheus.namespace<span style=color:#f92672>=</span>monitoring <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --set monitoring.serviceMonitor.labels.k8s-app<span style=color:#f92672>=</span>prometheus | kubectl apply -f -
</code></pre></div><h2 id=next-steps>Next Steps</h2><ul><li>Learn how to monitor Stash using built-in Prometheus from <a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/builtin>here</a>.</li><li>Learn how to monitor Stash using Prometheus operator from <a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/coreos>here</a>.</li><li>Learn how to use Grafana dashboard to visualize monitoring data from <a href=/docs/v2020.11.06/guides/v1alpha1/monitoring/grafana>here</a>.</li></ul></div></div><div class="column is-2"><div class=right-sidebar-area><div class=search-area><form action=#><input id=acSearch type=text placeholder=Search...>
<button class=search-button>
<i class="fa fa-search" aria-hidden=true></i></button></form></div><div class=tbl-of-contents><h4>What's on this Page</h4><nav id=TableOfContents><ul><li><a href=#overview>Overview</a><ul><li><a href=#backup--recovery-metrics>Backup & Recovery Metrics</a></li><li><a href=#operator-metrics>Operator Metrics</a></li></ul></li><li><a href=#how-to-enable-monitoring>How to Enable Monitoring</a></li><li><a href=#next-steps>Next Steps</a></li></ul></nav></div></div></div></div></div><script>var kdDropdown=document.querySelector(".dropdown");var kdDropdownBtn=document.querySelector(".dropdown-trigger");kdDropdownBtn.addEventListener("click",function(){kdDropdown.classList.toggle("is-active");})</script></div><div class=overlay-bg></div><div class=sidebar-search-area><div class=search-area-top><h3>Search</h3><div class=searchbar-area><input type=search name=search id=searchbox placeholder=Search...>
<button onclick=queryPage(1)><i class="fa fa-search" aria-hidden=true></i></button></div><span id=searchbar-script-container style=display:none></span><div class="search-meta-information level"><div class=level-left></div></div></div><div class=search-result-wrapper></div><div class=pagination-area><div class=pagination-list></div></div></div><div class=improve-section-area><div class="container section"><div class=improve-bg-color><div class=columns><div class="column is-6"><a href=https://github.com/stashed/docs/edit/master/docs/guides/v1alpha1/monitoring/overview.md/>Improve This Page</a></div></div></div></div></div><script type=text/javascript>var pageSize=5;var acSearch=document.querySelector("#acSearch");var bodyOverlay=document.querySelector(".overlay-bg");var sidebarSearch=document.querySelector(".sidebar-search-area");acSearch.addEventListener("click",function(){bodyOverlay.style.display="block";sidebarSearch.style.right="0";document.getElementById("searchbox").focus();bodyOverlay.addEventListener("click",function(){bodyOverlay.style.display="none";sidebarSearch.style.right="-80%";});});function encodeQueryData(data){var ret=[];for(var d in data)
ret.push(encodeURIComponent(d)+'='+encodeURIComponent(data[d]));return ret.join('&');}
document.querySelector(".searchbar-area input[type=search]").addEventListener("keyup",function(event){event.preventDefault();if(event.keyCode===13){queryPage(1);}});function queryPage(idx){var q=document.getElementById("searchbox").value;var cx="015199383701854252104:0pfqfvpvwyl";var key="AIzaSyBo15AW3hatf4fO8actJUZ_d5qZJpx0rXM";var imgSize="small";var callback="renderResult";var src="https://www.googleapis.com/customsearch/v1?"+encodeQueryData({q:q,cx:cx,key:key,imgSize:imgSize,callback:callback,start:(idx-1)*pageSize+1,num:pageSize,});var newScript=document.createElement("script");newScript.src=src;e=document.getElementById("searchbar-script-container");var child=e.lastElementChild;if(child){e.removeChild(child);}
e.appendChild(newScript);}
function renderSearchResultEntry(e){var out='<div class="single-search-result">'+
'<h3><a href="'+e.link+'">'+e.title+'</a></h3>'+
'<a href="'+e.link+'">'+e.htmlFormattedUrl+'</a>'+
'<div class="result-description-wrapper">';if(e.pagemap&&e.pagemap.cse_thumbnail){out+='<div class="result-thumb">'+
'<img src="'+e.pagemap.cse_thumbnail[0].src+'" alt="" />'+
'</div>';}
out+='<div class="result-description">'+
'<p>'+
e.snippet+
'</p>'+
'</div>'+
'</div>'+
'</div>';return out;}
function renderResult(response){document.querySelector(".search-meta-information .level-left").innerHTML='<div class="level-left">'+
'<p>'+
'About <span class="search-count">'+response.searchInformation.formattedTotalResults+'</span> results (<span class="time-count">'+response.searchInformation.formattedSearchTime+' </span>seconds)'+
'</p>'+
'</div>';if(!response.items){return;}
var searchResultWrapper=document.querySelector(".search-result-wrapper");searchResultWrapper.innerHTML="";for(var i=0;i<response.items.length;i++){searchResultWrapper.innerHTML+=renderSearchResultEntry(response.items[i]);}
var pager='<ul>';if(response.queries.previousPage){var pageIndex=Math.floor(response.queries.previousPage[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')">Previous</a></li>';}
if(response.queries.request){var pageIndex=Math.floor(response.queries.request[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')" class="is-active">'+pageIndex+'</a></li>';}
if(response.queries.nextPage){var pageIndex=Math.floor(response.queries.nextPage[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')">Next</a></li>';}
pager+='</ul>';document.querySelector(".pagination-area .pagination-list").innerHTML=pager;}</script><section></section><section></section><section></section><button class=go-to-top id=goTop>
<i class="fa fa-angle-up" aria-hidden=true></i></button><footer class=footer-area><div class=footer-top><div class="container section"><div class="columns is-mobile is-multiline"><div class="column is-full-mobile is-one-third-desktop is-one-third-widescreen is-one-third-tablet" data-aos=fade-up><div class=single-footer-widget><div class=footer-logo><a href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode class=img></a></div><div class=subscription-form><form action="https://appscode.us17.list-manage.com/subscribe/post?u=feb2bf31969a951e7449048a3&id=82fb19acb9" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=navbar-form target=_blank novalidate role=email role=email><label for=email>Subscribe to Our Newsletter</label><p class=spam-message>No spam, we promise. Your mail address is secure</p><div class="field has-addons"><div class=control><input class=input name=EMAIL id=mce-EMAIL type=email placeholder="Your work email address" required>
<button id=mc-embedded-subscribe type=submit name=subscribe class=button>
<i class="fa fa-paper-plane-o" aria-hidden=true></i></button></div></div></form></div><div class=contact-information><h4>Have any Inquiry?</h4><ul class=all-contact-info><li><a href=callto:+1%28650%29241-8486><span><i class="fa fa-phone" aria-hidden=true></i></span>+1(650)241-8486</a></li><li><a href=mailto:support@appscode.com><span><i class="fa fa-envelope-o" aria-hidden=true></i></span>support@appscode.com</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=500><div class=single-footer-widget><div class=footer-menu><h4>Products</h4><ul class=footer-link><li><a href=https://kubedb.com>KubeDB</a></li><li><a href=https://stash.run>Stash</a></li><li><a href=https://kubevault.com>KubeVault</a></li><li><a href=https://kubeform.com>Kubeform</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=600><div class=single-footer-widget><div class=footer-menu><h4>Services</h4><ul class=footer-link><li><a href=https://appscode.com/pricing/>Pricing</a></li><li><a href=https://appscode.com/consulting/>Consulting</a></li><li><a href=https://appscode.com/training/>Training</a></li><li><a href=https://appscode.com/support/>Support</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=700><div class=single-footer-widget><div class=footer-menu><h4>Company</h4><ul class=footer-link><li><a href=https://appscode.com/about/>About Us</a></li><li><a href=https://blog.byte.builders>Blog</a></li><li><a href=https://appscode.com/contact/>Contact Us</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=800><div class=single-footer-widget><div class=footer-menu><h4>Legal</h4><ul class=footer-link><li><a href=https://appscode.com/legal/tos/>Terms of Sevice</a></li><li><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a></li><li><a href=https://appscode.com/legal/security/>Security</a></li><li><a href=https://appscode.com/legal/sla/>Service Level Agreement</a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container section"><div class=columns><div class="column is-4"><p>© 2020 AppsCode Inc. All rights reserved.</p></div><div class="column is-4 is-mobile has-text-centered"><div class=footer-inline-link><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a>
<a href=https://appscode.com/legal/tos/>Terms of Service</a></div></div><div class="column is-4 is-mobile has-text-right"><div class=socail-link-inline><ul><li><a href=https://twitter.com/AppsCodeHQ><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a href=https://www.facebook.com/appscode><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href=https://www.youtube.com/c/AppsCodeInc><i class="fa fa-youtube" aria-hidden=true></i></a></li></ul></div></div></div></div></div></footer><script src=/assets/js/bulma-carousel.min.js></script><script src=https://unpkg.com/aos@2.3.1/dist/aos.js></script><script src=https://unpkg.com/downloadjs@1.4.7/download.min.js></script><script src=https://unpkg.com/clipboard@2/dist/clipboard.min.js></script><script src=/assets/js/main.js></script><script type=text/javascript>var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date();(function(){var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];s1.async=true;s1.src='https://embed.tawk.to/5821e34b18d9f16af02864b7/default';s1.charset='UTF-8';s1.setAttribute('crossorigin','*');s0.parentNode.insertBefore(s1,s0);})();</script></body></html>